# Overview
This [project](https://github.com/farah-afifi/watson-google-bot) contains sample code that shows how to build chatbots using telegram that leverages IBM Watson Assistant and Custom Google 

This project was created to furthur the capabilities of watson assistant from a domain based question answering bot into a non-domain one 

# Prerequisites and Setup

## 1. Credentials
You need three different sets of credentials.
1. **Watson Assistant credentials :**  

here we are using Watson Assistant V2 with version 2019-02-28 , read this [documentation](https://cloud.ibm.com/apidocs/assistant-v2?code=python) well to get the hang of how Watson Assistant is used here.

**you should acquire :** 
- iam_apikey
- assistant_id

>To see the service credentials and the assistant ID of an assistant, open the assistant settings and click API Details.
          
2. **Custom Google Search credentials:**

you can follow these [instructions](https://developers.google.com/custom-search/docs/tutorial/creatingcse) to get your Search engine ID.
Then follow these [instructions](http://valvepress.com/how-to-create-a-google-custom-search-api-key/) to get ypur API key.

**you should acquire :** 
- Search engine ID
- Custom Search API

3. **Telegram API Token:**

Follow the [instructions](https://www.siteguarding.com/en/how-to-get-telegram-bot-api-token) to get your Telegram API Token from BotFather 

**you should acquire :** 
- API Token


## 2. required installations

```
pip install --upgrade "ibm-watson>=3.2.0"
pip install requests
pip install configparser
pip install google-api-python-client
```
## 3. Filling out the Credentials

1. in [config.cfg](https://github.com/farah-afifi/watson-google-bot/blob/master/config.cfg)

Delete the text including the <> and paster your Telegram API here

```
[creds]
token = <your token generated by botfather>
```
2. in [server.py](https://github.com/farah-afifi/watson-google-bot/blob/master/server.py) 

replace the <TEXT> with the previously acquired  Watson Assistant API Key and with the assistant ID

```
service=ibm_watson.AssistantV2(
    version='2019-02-28',
    iam_apikey='<your generated API key on watson assistant credentials>',
    url='https://gateway-lon.watsonplatform.net/assistant/api'
)
assistant_id='<assistant_id>'
```
3. in [response_handler.py](https://github.com/farah-afifi/watson-google-bot/blob/master/response_handler.py)

replace <TEXT> with your Google CSE API key  and with yout CSE ID

```
if len(response["output"]["intents"]) > 0 and response["output"]["intents"][0]['intent'] != 'Google_Custom_Search':
          return response["output"]["generic"][0]['text']
else:
	resource = build("customsearch", 'v1', developerKey="<your api key generated on https://console.developers.google.com/>").cse()
          try:
	          result = resource.list(q=msg, cx='<your custom search engine ID on http://cse.google.com/>').execute(
```

## Now Try It Out!

once you run code after the modifications your bot on telegram shoulf be able to host your pre-trained watson assistant and is going to get the snippet responses from google to answer a whole variety of questions
  
